SCSI commands
=============

CDB Format
----------

Documentation:

* https://www.seagate.com/staticfiles/support/disc/manuals/scsi/100293068a.pdf
* https://en.wikipedia.org/wiki/SCSI_command
* http://www.t10.org/lists/op-num.htm

A CDB (Command Descriptor Block) can use 6-byte, 10-byte, 12-byte and 16-byte commands.
The 3 most significant bits of an operation code (*opcode*) defines the *group code*:

+------------------+---------------+--------------------+
| Group code (bin) | Opcode range  | Meaning            |
+==================+===============+====================+
|     ``000``      | ``0x00-0x1f`` | 6-byte command     |
+------------------+---------------+--------------------+
|     ``001``      | ``0x20-0x3f`` | 10-byte command    |
+------------------+---------------+--------------------+
|     ``010``      | ``0x40-0x5f`` | 10-byte command    |
+------------------+---------------+--------------------+
|     ``011``      | ``0x60-0x7f`` | Reserved           |
+------------------+---------------+--------------------+
|     ``100``      | ``0x80-0x9f`` | 16-byte command    |
+------------------+---------------+--------------------+
|     ``101``      | ``0xa0-0xbf`` | 12-byte command    |
+------------------+---------------+--------------------+
|     ``110``      | ``0xc0-0xdf`` | Vendor Specific    |
+------------------+---------------+--------------------+
|     ``111``      | ``0xe0-0xff`` | Vendor Specific    |
+------------------+---------------+--------------------+


Common SCSI commands
--------------------

Notations:

* ``u16be`` means *unsigned 16-bit integer encoded in Big Endian*
* ``u32be`` means *unsigned 32-bit integer encoded in Big Endian*

Commands used by tools from http://sg.danny.cz/sg/sg3_utils.html (table from https://github.com/hreinecke/sg3_utils/blob/v1.43/lib/sg_lib_data.c):

+------------------------------------------------------------------+
| 6-byte commands                                                  |
+----------+-------------------------------------------------------+
|  Opcode  | DEVICE Name (description)                             |
+==========+=======================================================+
| ``0x00`` | Test Unit Ready                                       |
+----------+-------------------------------------------------------+
| ``0x01`` | Rezero Unit                                           |
|          +-------------------------------------------------------+
|          | TAPE Rewind                                           |
+----------+-------------------------------------------------------+
| ``0x03`` | Request Sense                                         |
+----------+-------------------------------------------------------+
| ``0x04`` | Format Unit                                           |
|          +-------------------------------------------------------+
|          | TAPE Format medium                                    |
|          +-------------------------------------------------------+
|          | PRINTER Format                                        |
+----------+-------------------------------------------------------+
| ``0x05`` | Read Block Limits                                     |
+----------+-------------------------------------------------------+
| ``0x07`` | Reassign Blocks                                       |
|          +-------------------------------------------------------+
|          | MCHANGER Initialize element status                    |
+----------+-------------------------------------------------------+
| ``0x08`` | Read(6) [obsolete in sbc3r30]                         |
|          +-------------------------------------------------------+
|          | PROCESSOR Receive                                     |
+----------+-------------------------------------------------------+
| ``0x0a`` | Write(6) [obsolete in sbc3r30]                        |
|          +-------------------------------------------------------+
|          | PRINTER Print                                         |
|          +-------------------------------------------------------+
|          | PROCESSOR Send                                        |
+----------+-------------------------------------------------------+
| ``0x0b`` | Seek(6)                                               |
|          +-------------------------------------------------------+
|          | TAPE Set capacity                                     |
|          +-------------------------------------------------------+
|          | PRINTER Slew and print                                |
+----------+-------------------------------------------------------+
| ``0x0f`` | Read reverse(6)                                       |
+----------+-------------------------------------------------------+
| ``0x10`` | Write filemarks(6)                                    |
|          +-------------------------------------------------------+
|          | PRINTER Synchronize buffer                            |
+----------+-------------------------------------------------------+
| ``0x11`` | Space(6)                                              |
+----------+-------------------------------------------------------+
| ``0x12`` | Inquiry                                               |
+----------+-------------------------------------------------------+
| ``0x13`` | Verify(6) [SSC]                                       |
+----------+-------------------------------------------------------+
| ``0x14`` | Recover buffered data                                 |
+----------+-------------------------------------------------------+
| ``0x15`` | Mode select(6)                                        |
+----------+-------------------------------------------------------+
| ``0x16`` | Reserve(6) [obsolete in SPC-4 r11]                    |
|          +-------------------------------------------------------+
|          | MCHANGER Reserve element(6)                           |
+----------+-------------------------------------------------------+
| ``0x17`` | Release(6) [obsolete in SPC-4 r11]                    |
|          +-------------------------------------------------------+
|          | MCHANGER Release element(6)                           |
+----------+-------------------------------------------------------+
| ``0x18`` | Copy [obsolete in SPC-4 r11]                          |
+----------+-------------------------------------------------------+
| ``0x19`` | Erase(6)                                              |
+----------+-------------------------------------------------------+
| ``0x1a`` | Mode sense(6)                                         |
+----------+-------------------------------------------------------+
| ``0x1b`` | Start stop unit                                       |
|          |                                                       |
|          | ``cdb[4] & 0x3 == 2`` means "media eject"             |
|          +-------------------------------------------------------+
|          | TAPE Load unload                                      |
|          +-------------------------------------------------------+
|          | ADC Load unload                                       |
|          +-------------------------------------------------------+
|          | PRINTER Stop print                                    |
+----------+-------------------------------------------------------+
| ``0x1c`` | Receive diagnostic results                            |
+----------+-------------------------------------------------------+
| ``0x1d`` | Send diagnostic                                       |
+----------+-------------------------------------------------------+
| ``0x1e`` | Prevent allow medium removal                          |
|          |                                                       |
|          | ``cdb[4] & 0x1 == 1`` means "media removal prevented" |
+----------+-------------------------------------------------------+

+-----------------------------------------------------------------------------------------------------------------------------+
| 10-byte commands                                                                                                            |
+----------+-----------------------------------------------+------------+-----------------------------------------------------+
|  Opcode  | DEVICE Name (description)                     | Parameters | Response                                            |
+==========+===============================================+============+=====================================================+
| ``0x23`` | Read Format capacities                        |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x24`` | Set window                                    |                                                                  |
+----------+-----------------------------------------------+------------+-----------------------------------------------------+
| ``0x25`` | Read capacity(10)                             |            | * ``u32be resp[0,1,2,3]`` number of sectors - 1     |
|          |                                               |            | * ``u16be resp[4,5]`` zero                          |
|          |                                               |            | * ``u16be resp[6,7]`` bytes/sector (e.g. 512, 2048) |
|          +-----------------------------------------------+------------+-----------------------------------------------------+
|          | OCRW Read card capacity                       |                                                                  |
+----------+-----------------------------------------------+------------------------------------------------------------------+
| ``0x28`` | Read(10)                                      | * ``u32be cdb[2,3,4,5]`` = sector offset                         |
|          |                                               | * ``u16be cdb[7,8]`` = number of sectors                         |
+----------+-----------------------------------------------+------------------------------------------------------------------+
| ``0x29`` | Read generation                               |                                                                  |
+----------+-----------------------------------------------+------------------------------------------------------------------+
| ``0x2a`` | Write(10)                                     | * ``u32be cdb[2,3,4,5]`` = sector offset                         |
|          |                                               | * ``u16be cdb[7,8]`` = number of sectors                         |
+----------+-----------------------------------------------+------------------------------------------------------------------+
| ``0x2b`` | Seek(10)                                      |                                                                  |
|          +-----------------------------------------------+                                                                  |
|          | TAPE Locate(10)                               |                                                                  |
|          +-----------------------------------------------+                                                                  |
|          | MCHANGER Position to element                  |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x2c`` | Erase(10)                                     |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x2d`` | Read updated block                            |                                                                  |
+----------+-----------------------------------------------+------------------------------------------------------------------+
| ``0x2e`` | Write and verify(10)                          |  same parameters as Write(10)                                    |
+----------+-----------------------------------------------+------------------------------------------------------------------+
| ``0x2f`` | Verify(10)                                    |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x30`` | Search data high(10)                          |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x31`` | Search data equal(10)                         |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x32`` | Search data low(10)                           |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x33`` | Set limits(10)                                |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x34`` | Pre-fetch(10)                                 |                                                                  |
|          +-----------------------------------------------+                                                                  |
|          | TAPE Read position                            |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x35`` | Synchronize cache(10)                         |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x36`` | Lock unlock cache(10)                         |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x37`` | Read defect data(10)                          |                                                                  |
|          +-----------------------------------------------+                                                                  |
|          | MCHANGER Initialize element status with range |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x38`` | Medium scan                                   |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x39`` | Compare [obsolete in SPC-4 r11]               |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x3a`` | Copy and verify [obsolete in SPC-4 r11]       |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x3b`` | Write buffer                                  |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x3c`` | Read buffer(10)                               |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x3d`` | Update block                                  |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x3e`` | Read long(10) [obsolete in SBC-4 r7]          |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x3f`` | Write long(10)                                |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x40`` | Change definition [obsolete in SPC-4 r11]     |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x41`` | Write same(10)                                |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x42`` | Unmap [added SPC-4 rev 18]                    |                                                                  |
|          | (like Trim: no longer use a block)            |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x42`` | MMC Read sub-channel                          |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x43`` | MMC Read TOC/PMA/ATIP                         |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x44`` | Report density support                        |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x45`` | MMC Play audio(10)                            |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x46`` | MMC Get configuration                         |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x47`` | MMC Play audio msf                            |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x48`` | Sanitize                                      |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x4a`` | MMC Get event status notification             |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x4b`` | MMC Pause/resume                              |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x4c`` | Log select                                    |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x4d`` | Log sense                                     |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x4e`` | Stop play/scan                                |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x50`` | Xdwrite(10) [obsolete in SBC-3 r31]           |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x51`` | Xpwrite(10)                                   |                                                                  |
|          +-----------------------------------------------+                                                                  |
|          | MMC Read disk information                     |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x52`` | Xdread(10) [obsolete in SBC-3 r31]            |                                                                  |
|          +-----------------------------------------------+                                                                  |
|          | MMC Read track information                    |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x53`` | Xdwriteread(10)                               |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x54`` | Send OPC information                          |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x55`` | Mode select(10)                               |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x56`` | Reserve(10) [obsolete in SPC-4 r11]           |                                                                  |
|          +-----------------------------------------------+                                                                  |
|          | MCHANGER Reserve element(10)                  |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x57`` | Release(10) [obsolete in SPC-4 r11]           |                                                                  |
|          +-----------------------------------------------+                                                                  |
|          | MCHANGER Release element(10)                  |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x58`` | Repair track                                  |                                                                  |
+----------+-----------------------------------------------+------------------------------------------------------------------+
| ``0x5a`` | Mode sense(10)                                | * ``u16be cdb[7,8]`` = length of command data                    |
+----------+-----------------------------------------------+------------------------------------------------------------------+
| ``0x5b`` | Close track/session                           |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x5c`` | Read buffer capacity                          |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x5d`` | Send cue sheet                                |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x5e`` | Persistent reserve in                         |                                                                  |
+----------+-----------------------------------------------+                                                                  |
| ``0x5f`` | Persistent reserve out                        |                                                                  |
+----------+-----------------------------------------------+------------------------------------------------------------------+

+------------------------------------------------------------------+
| Reserved commands                                                |
+----------+-------------------------------------------------------+
|  Opcode  | DEVICE Name (description)                             |
+==========+=======================================================+
| ``0x7e`` | Extended cdb (XCBD) [added in SPC-4 r12]              |
+----------+-------------------------------------------------------+

+------------------------------------------------------------------+
| 16-byte commands                                                 |
+----------+-------------------------------------------------------+
|  Opcode  | DEVICE Name (description)                             |
+==========+=======================================================+
| ``0x80`` | Xdwrite extended(16)                                  |
|          +-------------------------------------------------------+
|          | TAPE Write filemarks(16)                              |
+----------+-------------------------------------------------------+
| ``0x81`` | Rebuild(16)                                           |
|          +-------------------------------------------------------+
|          | TAPE Read reverse(16)                                 |
+----------+-------------------------------------------------------+
| ``0x82`` | Regenerate(16)                                        |
+----------+-------------------------------------------------------+
| ``0x83`` | Third party copy out                                  |
|          +-------------------------------------------------------+
|          | Extended copy [before spc4r34]                        |
+----------+-------------------------------------------------------+
| ``0x84`` | Third party copy in                                   |
|          +-------------------------------------------------------+
|          | Receive copy results [before spc4r34]                 |
+----------+-------------------------------------------------------+
| ``0x85`` | ATA pass-through(16) [was 0x98 in spc3 rev21c]        |
+----------+-------------------------------------------------------+
| ``0x86`` | Access control in                                     |
+----------+-------------------------------------------------------+
| ``0x87`` | Access control out                                    |
+----------+-------------------------------------------------------+
| ``0x88`` | Read(16)                                              |
+----------+-------------------------------------------------------+
| ``0x89`` | Compare and write                                     |
+----------+-------------------------------------------------------+
| ``0x8a`` | Write(16)                                             |
+----------+-------------------------------------------------------+
| ``0x8b`` | Orwrite(16)                                           |
+----------+-------------------------------------------------------+
| ``0x8c`` | Read attribute                                        |
+----------+-------------------------------------------------------+
| ``0x8d`` | Write attribute                                       |
+----------+-------------------------------------------------------+
| ``0x8e`` | Write and verify(16)                                  |
+----------+-------------------------------------------------------+
| ``0x8f`` | Verify(16)                                            |
+----------+-------------------------------------------------------+
| ``0x90`` | Pre-fetch(16)                                         |
+----------+-------------------------------------------------------+
| ``0x91`` | Synchronize cache(16)                                 |
|          +-------------------------------------------------------+
|          | TAPE Space(16)                                        |
+----------+-------------------------------------------------------+
| ``0x92`` | Lock unlock cache(16)                                 |
|          +-------------------------------------------------------+
|          | TAPE Locate(16)                                       |
+----------+-------------------------------------------------------+
| ``0x93`` | Write same(16)                                        |
|          +-------------------------------------------------------+
|          | TAPE Erase(16)                                        |
+----------+-------------------------------------------------------+
| ``0x94`` | ZBC ZBC out [new sbc4r04, has service actions]        |
+----------+-------------------------------------------------------+
| ``0x95`` | ZBC ZBC in [new sbc4r04, has service actions]         |
+----------+-------------------------------------------------------+
| ``0x98`` | ATA pass-through(16) [spc3 rev21c]                    |
+----------+-------------------------------------------------------+
| ``0x9a`` | Write stream(16) [added sbc4r07]                      |
+----------+-------------------------------------------------------+
| ``0x9b`` | Read buffer(16) [added spc5r02]                       |
+----------+-------------------------------------------------------+
| ``0x9c`` | Write atomic(16)                                      |
+----------+-------------------------------------------------------+
| ``0x9d`` | Service action bidirectional [added spc4r35]          |
+----------+-------------------------------------------------------+
| ``0x9e`` | Service action in(16)                                 |
+----------+-------------------------------------------------------+
| ``0x9f`` | Service action out(16)                                |
+----------+-------------------------------------------------------+

+-----------------------------------------------------------------------------------------------------+
| 12-byte commands                                                                                    |
+----------+-------------------------------------------+----------------------------------------------+
|  Opcode  | DEVICE Name (description)                 | Parameters                                   |
+==========+===========================================+==============================================+
| ``0xa0`` | Report luns                               |                                              |
+----------+-------------------------------------------+                                              |
| ``0xa1`` | ATA pass-through(12)                      |                                              |
|          +-------------------------------------------+                                              |
|          | MMC Blank                                 |                                              |
+----------+-------------------------------------------+                                              |
| ``0xa2`` | Security protocol in                      |                                              |
+----------+-------------------------------------------+                                              |
| ``0xa3`` | Maintenance in                            |                                              |
|          +-------------------------------------------+                                              |
|          | MMC Send key                              |                                              |
+----------+-------------------------------------------+                                              |
| ``0xa4`` | Maintenance out                           |                                              |
|          +-------------------------------------------+                                              |
|          | MMC Report key                            |                                              |
+----------+-------------------------------------------+                                              |
| ``0xa5`` | Move medium                               |                                              |
|          +-------------------------------------------+                                              |
|          | MMC Play audio(12)                        |                                              |
+----------+-------------------------------------------+                                              |
| ``0xa6`` | Exchange medium                           |                                              |
|          +-------------------------------------------+                                              |
|          | MMC Load/unload medium                    |                                              |
+----------+-------------------------------------------+                                              |
| ``0xa7`` | Move medium attached                      |                                              |
|          +-------------------------------------------+                                              |
|          | MMC Set read ahead                        |                                              |
+----------+-------------------------------------------+----------------------------------------------+
| ``0xa8`` | Read(12)                                  | * ``u32be cdb[2,3,4,5]`` = sector offset     |
|          |                                           | * ``u16be cdb[6,7,8,9]`` = number of sectors |
+----------+-------------------------------------------+----------------------------------------------+
| ``0xa9`` | Service action out(12)                    |                                              |
+----------+-------------------------------------------+----------------------------------------------+
| ``0xaa`` | Write(12)                                 | * ``u32be cdb[2,3,4,5]`` = sector offset     |
|          |                                           | * ``u16be cdb[6,7,8,9]`` = number of sectors |
+----------+-------------------------------------------+----------------------------------------------+
| ``0xab`` | Service action in(12)                     |                                              |
+----------+-------------------------------------------+                                              |
| ``0xac`` | erase(12)                                 |                                              |
|          +-------------------------------------------+                                              |
|          | MMC Get performance                       |                                              |
+----------+-------------------------------------------+                                              |
| ``0xad`` | MMC Read DVD/BD structure                 |                                              |
+----------+-------------------------------------------+                                              |
| ``0xae`` | Write and verify(12)                      |                                              |
+----------+-------------------------------------------+                                              |
| ``0xaf`` | Verify(12)                                |                                              |
+----------+-------------------------------------------+                                              |
| ``0xb0`` | Search data high(12)                      |                                              |
+----------+-------------------------------------------+                                              |
| ``0xb1`` | Search data equal(12)                     |                                              |
|          +-------------------------------------------+                                              |
|          | MCHANGER Open/close import/export element |                                              |
+----------+-------------------------------------------+                                              |
| ``0xb2`` | Search data low(12)                       |                                              |
+----------+-------------------------------------------+                                              |
| ``0xb3`` | Set limits(12)                            |                                              |
+----------+-------------------------------------------+                                              |
| ``0xb4`` | Read element status attached              |                                              |
+----------+-------------------------------------------+                                              |
| ``0xb5`` | Security protocol out                     |                                              |
|          +-------------------------------------------+                                              |
|          | MCHANGER Request volume element address   |                                              |
+----------+-------------------------------------------+                                              |
| ``0xb6`` | Send volume tag                           |                                              |
|          +-------------------------------------------+                                              |
|          | MMC Set streaming                         |                                              |
+----------+-------------------------------------------+                                              |
| ``0xb7`` | Read defect data(12)                      |                                              |
+----------+-------------------------------------------+                                              |
| ``0xb8`` | Read element status                       |                                              |
+----------+-------------------------------------------+                                              |
| ``0xb9`` | Read CD msf                               |                                              |
+----------+-------------------------------------------+                                              |
| ``0xba`` | Redundancy group in                       |                                              |
|          +-------------------------------------------+                                              |
|          | MMC Scan                                  |                                              |
+----------+-------------------------------------------+                                              |
| ``0xbb`` | Redundancy group out                      |                                              |
|          +-------------------------------------------+                                              |
|          | MMC Set CD speed                          |                                              |
+----------+-------------------------------------------+                                              |
| ``0xbc`` | Spare in                                  |                                              |
+----------+-------------------------------------------+                                              |
| ``0xbd`` | Spare out                                 |                                              |
|          +-------------------------------------------+                                              |
|          | MMC Mechanism status                      |                                              |
+----------+-------------------------------------------+                                              |
| ``0xbe`` | Volume set in                             |                                              |
|          +-------------------------------------------+                                              |
|          | MMC Read CD                               |                                              |
+----------+-------------------------------------------+                                              |
| ``0xbf`` | Volume set out                            |                                              |
|          +-------------------------------------------+                                              |
|          | MMC Send DVD/BD structure                 |                                              |
+----------+-------------------------------------------+----------------------------------------------+



Command examples:

* ``0x12``: ``INQUIRY LUN``:

  - example (command ``sg_ses``)::

      > 12 00 00 00 24 00 (opcode 12, CMDT=0, EVPD=0, allocation length=0x0024)
      < 00 80 06 02 3b 00 00 00 4b 69 6e 67 73 74 6f 6e
      < 44 54 32 30 30 30 20 20 20 20 20 20 20 20 20 20
      < 30 31 00 00
          Device type: 00 disk device
          vendor: Kingston
          product: DT2000
          revision level: 01

  - example (command ``sdparm --inquiry``)::

      > 12 01 83 00 fc 00
          opcode 12, CMDT=0, EVPD=1,
          EVPD Page Code: 0x83 Device Identification Page
          allocation length=0x00fc
          LUN 0
      < 00 83 00 1c 02 01 00 18 32 30 30 39 31 36 41 46  ........200916AF
      < 36 36 30 31 37 34 37 45 30 44 38 45 45 39 30 32  6601747E0D8EE902
          designator type: T10 vendor identification
          code set: ASCII
          serial number:
              vendor id: 200916AF
              vendor specific: 6601747E0D8EE902

* ``0x1c``: ``RECEIVE DIAGNOSTIC LUN``:

  - example (command ``sg_ses``)::

      > 1c 01 00 ff fc 00
      < 70 00 05 00 00 00 00 0a 00 00 00 00 20 00 00 00
      < 00 00
      (failure)

* ``0x25``: ``READ CAPACITY``:

  - 8-byte response: ``u32be`` last logical block address, ``u32be`` logical block length
  - example (command ``sg_readcap``)::

      > 25 00 00 00 00 00 00 00 00 00
      < 07 34 ff ff 00 00 02 00 : last LBA 0x734ffff, block length 512 => 61.91 GB

* ``0x55``: ``MODE SELECT``:

  - example (command ``sdparm --set=WCE``)::

      > 55 10 00 00 00 00 00 00 1c 00
          ("0x001c" for allocation length, got from command 0x5a MODE SENSE)
      < 00 00 00 00 00 00 00 00 08 12 04 00 00 00 00 00
      < 00 00 00 00 00 00 00 00 00 00 00 00


* ``0x5a``: ``MODE SENSE``:

  - pages:

    - ``0x08``: Caching mode page
    - ``0x0a``: Control mode page
    - ``0x1c``: Informational Exceptions mode page
    - ``0x3f``: List pages

  - example (command ``sg_rdac``) display RDAC redundant controller mode page::

      > 5a 00 2c 01 00 00 00 01 34 00
      < 00 06 00 80 00 00 00 00
          size 0x0006

  - example (command ``sdparm --get=WCE`` to get Write Cache Enable)::

      > 5a 00 08 00 00 00 00 00 1c 00
          "08": SBC-2 page 2: caching ; page control: current values
          "0x001c" for allocation length
      < 00 1a 00 80 00 00 00 00 08 12 00 00 00 00 00 00
      < 00 00 00 00 00 00 00 00 00 00 00 00
          size 0x001a

      > 5a 00 48 00 00 00 00 00 1c 00
          "48": SBC-2 page 2: caching ; page control: changeable values
      < ... (idem)
      > 5a 00 88 00 00 00 00 00 1c 00
          "88": SBC-2 page 2: caching ; page control: default values
      < ... (idem)
      > 5a 00 c8 00 00 00 00 00 1c 00
          "c8": SBC-2 page 2: caching ; page control: saved values
      < ... (idem)

      with WCE:
      < 00 1a 00 80 00 00 00 00 08 12 04 00 00 00 00 00 (there is a 04)
      < 00 00 00 00 00 00 00 00 00 00 00 00

  - example of bad page (command ``sdparm --page=1 --hex``)::
  
      > 5a 00 01 00 00 00 00 00 08 00
      < 00 06 00 80 00 00 00 00
